<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›¾ç‰‡ç»„ä»¶æµ‹è¯• - DgrmJS</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8f9fa;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            background: #f8f9fa;
        }
        
        .test-section h3 {
            margin-top: 0;
            color: #495057;
        }
        
        .instructions {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid #2196f3;
        }
        
        .instructions h4 {
            margin-top: 0;
            color: #1976d2;
        }
        
        .step {
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 4px;
            border-left: 3px solid #28a745;
        }
        
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            margin: 5px;
        }
        
        .btn:hover {
            background: #0056b3;
        }
        
        .btn.success {
            background: #28a745;
        }
        
        .btn.success:hover {
            background: #1e7e34;
        }
        
        .code {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ–¼ï¸ å›¾ç‰‡ç»„ä»¶åŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="instructions">
            <h4>ğŸ“‹ æµ‹è¯•è¯´æ˜</h4>
            <p>æœ¬é¡µé¢ç”¨äºæµ‹è¯•æ–°å¢çš„å›¾ç‰‡ç»„ä»¶åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ‹–æ‹½åˆ›å»ºå’ŒåŒå‡»ä¸Šä¼ åŠŸèƒ½ã€‚</p>
        </div>

        <div class="test-section">
            <h3>ğŸ¯ æµ‹è¯•æ­¥éª¤</h3>
            
            <div class="step">
                <strong>æ­¥éª¤ 1:</strong> æ‰“å¼€DgrmJSå›¾è¡¨ç¼–è¾‘å™¨
            </div>
            
            <div class="step">
                <strong>æ­¥éª¤ 2:</strong> åœ¨å·¦ä¾§å·¥å…·æ ä¸­æ‰¾åˆ°æ–°çš„å›¾ç‰‡ç»„ä»¶æŒ‰é’®ï¼ˆè™šçº¿æ–¹æ¡†å›¾æ ‡ï¼‰
            </div>
            
            <div class="step">
                <strong>æ­¥éª¤ 3:</strong> æ‹–æ‹½å›¾ç‰‡ç»„ä»¶åˆ°ç”»å¸ƒä¸Š
            </div>
            
            <div class="step">
                <strong>æ­¥éª¤ 4:</strong> åŒå‡»å›¾ç‰‡ç»„ä»¶ï¼Œåº”è¯¥å¼¹å‡ºæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†
            </div>
            
            <div class="step">
                <strong>æ­¥éª¤ 5:</strong> é€‰æ‹©ä¸€å¼ å›¾ç‰‡æ–‡ä»¶è¿›è¡Œä¸Šä¼ æµ‹è¯•
            </div>
        </div>

        <div class="warning">
            <strong>âš ï¸ æ³¨æ„äº‹é¡¹ï¼š</strong>
            <ul>
                <li>å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½éœ€è¦å…ˆä¿å­˜å›¾è¡¨åˆ°Drupalï¼Œæ‰èƒ½ä¸Šä¼ å›¾ç‰‡åˆ°ref_imageså­—æ®µ</li>
                <li>å¦‚æœå›¾è¡¨å°šæœªä¿å­˜ï¼ŒåŒå‡»æ—¶ä¼šæç¤ºå…ˆä¿å­˜å›¾è¡¨</li>
                <li>ä¸Šä¼ æˆåŠŸåï¼Œå›¾ç‰‡ä¼šæ˜¾ç¤ºåœ¨ç»„ä»¶ä¸­ï¼Œè¾¹æ¡†å˜ä¸ºç»¿è‰²å®çº¿</li>
                <li>å›¾ç‰‡ä¼šè¢«ä¸Šä¼ åˆ°å½“å‰AIGCèŠ‚ç‚¹çš„ref_imageså­—æ®µä¸­</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>ğŸš€ å¿«é€Ÿæµ‹è¯•</h3>
            
            <button class="btn success" onclick="openDiagramEditor()">
                ğŸ“Š æ‰“å¼€å›¾è¡¨ç¼–è¾‘å™¨
            </button>
            
            <button class="btn" onclick="openWithExistingDiagram()">
                ğŸ“„ æ‰“å¼€ç°æœ‰å›¾è¡¨ï¼ˆç”¨äºæµ‹è¯•ä¸Šä¼ ï¼‰
            </button>
        </div>

        <div class="test-section">
            <h3>ğŸ” é¢„æœŸè¡Œä¸º</h3>
            
            <h4>âœ… ç»„ä»¶åˆ›å»º</h4>
            <div class="code">
- å·¥å…·æ æ˜¾ç¤ºå›¾ç‰‡ç»„ä»¶æŒ‰é’®ï¼ˆè™šçº¿æ–¹æ¡† + å›¾ç‰‡å›¾æ ‡ï¼‰
- æ‹–æ‹½åˆ°ç”»å¸ƒåæ˜¾ç¤ºè™šçº¿è¾¹æ¡†çš„å ä½ç¬¦
- æ˜¾ç¤º"åŒå‡»ä¸Šä¼ å›¾ç‰‡"æç¤ºæ–‡å­—
- åŒ…å«å›¾ç‰‡å ä½ç¬¦å›¾æ ‡ï¼ˆå±±å’Œå¤ªé˜³ï¼‰
            </div>
            
            <h4>âœ… åŒå‡»ä¸Šä¼ ï¼ˆæ–°å›¾è¡¨ï¼‰</h4>
            <div class="code">
- åŒå‡»ç»„ä»¶
- å¼¹å‡ºæç¤ºï¼š"è¯·å…ˆä¿å­˜å›¾è¡¨ï¼Œç„¶åæ‰èƒ½ä¸Šä¼ å›¾ç‰‡åˆ°ref_imageså­—æ®µ"
- ç”¨æˆ·éœ€è¦å…ˆé€šè¿‡èœå•ä¿å­˜å›¾è¡¨
            </div>
            
            <h4>âœ… åŒå‡»ä¸Šä¼ ï¼ˆå·²ä¿å­˜å›¾è¡¨ï¼‰</h4>
            <div class="code">
- åŒå‡»ç»„ä»¶
- å¼¹å‡ºæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†
- é€‰æ‹©å›¾ç‰‡æ–‡ä»¶
- æ˜¾ç¤º"ä¸Šä¼ ä¸­..."çŠ¶æ€
- ä¸Šä¼ æˆåŠŸåï¼š
  * å›¾ç‰‡æ˜¾ç¤ºåœ¨ç»„ä»¶ä¸­
  * è¾¹æ¡†å˜ä¸ºç»¿è‰²å®çº¿
  * éšè—å ä½ç¬¦å’Œæç¤ºæ–‡å­—
  * æ§åˆ¶å°æ˜¾ç¤ºæˆåŠŸæ—¥å¿—
            </div>
            
            <h4>âŒ é”™è¯¯å¤„ç†</h4>
            <div class="code">
- ç½‘ç»œé”™è¯¯ï¼šæ˜¾ç¤ºä¸Šä¼ å¤±è´¥æç¤º
- è®¤è¯å¤±è´¥ï¼šæç¤ºç”¨æˆ·ç™»å½•
- æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼šæ˜¾ç¤ºæ ¼å¼ä¸æ”¯æŒæç¤º
- æœåŠ¡å™¨é”™è¯¯ï¼šæ˜¾ç¤ºå…·ä½“é”™è¯¯ä¿¡æ¯
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ› ï¸ æŠ€æœ¯å®ç°</h3>
            
            <h4>ç»„ä»¶ç‰¹æ€§</h4>
            <ul>
                <li><strong>ç±»å‹ID:</strong> 6</li>
                <li><strong>é»˜è®¤å°ºå¯¸:</strong> 120x120 åƒç´ </li>
                <li><strong>è¿æ¥ç‚¹:</strong> ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘</li>
                <li><strong>å¯è°ƒæ•´å¤§å°:</strong> æ”¯æŒ</li>
                <li><strong>å›¾ç‰‡é€‚é…:</strong> ä¿æŒæ¯”ä¾‹ï¼Œå±…ä¸­è£å‰ª</li>
            </ul>
            
            <h4>ä¸Šä¼ æµç¨‹</h4>
            <ol>
                <li>æ£€æŸ¥å½“å‰å›¾è¡¨æ˜¯å¦å·²ä¿å­˜ï¼ˆæœ‰nodeIdï¼‰</li>
                <li>è°ƒç”¨ <code>drupalAPI.addImageToRefImagesField(file, nodeUuid)</code></li>
                <li>ä¸Šä¼ æ–‡ä»¶åˆ° <code>/jsonapi/node/aigc/ref_images</code></li>
                <li>è·å–ç°æœ‰ref_imageså€¼</li>
                <li>æ›´æ–°èŠ‚ç‚¹ï¼Œæ·»åŠ æ–°æ–‡ä»¶IDåˆ°ref_imagesæ•°ç»„</li>
                <li>æœ¬åœ°æ˜¾ç¤ºå›¾ç‰‡é¢„è§ˆ</li>
            </ol>
        </div>
    </div>

    <script>
        function openDiagramEditor() {
            const url = 'http://localhost:3001/index.dev.html';
            console.log('ğŸš€ Opening diagram editor for image component testing');
            console.log(`ğŸ”— URL: ${url}`);
            
            window.open(url, '_blank');
        }
        
        function openWithExistingDiagram() {
            // è¿™é‡Œå¯ä»¥æ”¾ä¸€ä¸ªå·²çŸ¥çš„UUIDç”¨äºæµ‹è¯•
            const testUuid = '12345678-1234-1234-1234-123456789abc';
            const url = `http://localhost:3001/index.dev.html?type=drupal&uuid=${testUuid}`;
            console.log('ğŸš€ Opening existing diagram for upload testing');
            console.log(`ğŸ”— URL: ${url}`);
            
            window.open(url, '_blank');
        }
        
        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
        window.addEventListener('load', () => {
            console.log('ğŸ“‹ Image component test page loaded');
            console.log('ğŸ”§ Ready to test image component functionality');
        });
    </script>
</body>
</html> 